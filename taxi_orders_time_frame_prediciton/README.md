# Временные ряды - предсказание нагрузки на сервис такси 

Построена модель регрессии для временных рядов: модель прогнозирует число заказов на следующий час используя данные за предыдущее время. Подбирались отстающие значения, анализировались тренды и сезонность временных рядов. В итоге лучшие результаты показала линейная регрессия, также проведено сравнение быстродействия моделей.

## Ссылка на полноценный просмотр ноутбука

https://nbviewer.org/github/anton-kaptoh/Practicum/blob/main/taxi_orders_time_frame_prediciton/TaxiOrdersTimeFramePrediction.ipynb

## Tags
time series, regression, pipeline, scikit-learn, statsmodels, LinearRegression, LighGBMRegressor, DecisionTreeRegressor, RandomForestRegressor

## Шаги/ход исследования
- [1.  Прогнозирование заказов такси](#1.--Прогнозирование-заказов-такси)
  - [1.1. Подготовка](#1.1.-Подготовка)
    - [1.1.1. Импорты](#1.1.1.-Импорты)
    - [1.1.2. Загрузка данных](#1.1.2.-Загрузка-данных)
  - [1.2. Анализ и преобразование датасета](#1.2.-Анализ-и-преобразование-датасета)
    - [1.2.1. Дополнительные признаки](#1.2.1.-Дополнительные-признаки)
    - [1.2.2. EDA](#1.2.2.-EDA)
    - [1.2.3. Тренды и сезонность](#1.2.3.-Тренды-и-сезонность)
    - [1.2.4. Вывод](#1.2.4.-Вывод)
  - [1.3. Обучение](#1.3.-Обучение)
    - [1.3.1. Разбиение данных на обучающую и тестовую выборки](#1.3.1.-Разбиение-данных-на-обучающую-и-тестовую-выборки)
    - [1.3.2. Сборка пайплайна](#1.3.2.-Сборка-пайплайна)
    - [1.3.3. Проверка модели на адекватность](#1.3.3.-Проверка-модели-на-адекватность)
    - [1.3.4. LGBMRegressor](#1.3.4.-LGBMRegressor)
    - [1.3.5. DecisionTreeRegressor](#1.3.5.-DecisionTreeRegressor)
    - [1.3.6. LinearRegression](#1.3.6.-LinearRegression)
    - [1.3.7. RandomForestRegressor](#1.3.7.-RandomForestRegressor)
    - [1.3.8. Вывод](#1.3.8.-Вывод)
  - [1.4. Тестирование](#1.4.-Тестирование)
  - [1.5. Выводы](#1.5.-Выводы)

## Выводы
Мы проанализировали различные модели для прогнозирования временных рядов, добавили во временной ряд дополнительные признаки (части даты, отстающие значения, скользящее среднее) для улучшения качества моделей. Лучше всего себя показала модель LinearRegression показав также на тестовой выборке RMSE порядка 34 (при требуемом максимуме 48). Кроме того, линейная регрессия является и практически самой быстрой из всех рассматриваемых моделей (на этом же уровне Decision Tree Regressor, но у него на кросс-валидации вышли гораздо бОльшие значения RMSE).